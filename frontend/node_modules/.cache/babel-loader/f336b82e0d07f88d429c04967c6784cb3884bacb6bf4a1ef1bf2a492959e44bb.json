{"ast":null,"code":"import React,{useState,useEffect}from'react';import ProductModal from'./ProductModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_BASE_URL=\"https://grocery-store-management-system.onrender.com\";function ManageProduct(){const[products,setProducts]=useState([]);const[showModal,setShowModal]=useState(false);const[selectedProduct,setSelectedProduct]=useState(null);const[searchTerm,setSearchTerm]=useState('');// New state for search\nconst[loading,setLoading]=useState(true);// New state for loading\nuseEffect(()=>{setLoading(true);// Set loading to true when fetch starts\nfetch(`${API_BASE_URL}/getProducts`).then(response=>response.json()).then(data=>setProducts(data||[]))// Ensure data is an array\n.catch(error=>console.error('Error fetching products:',error)).finally(()=>setLoading(false));// Set loading to false when fetch completes or fails\n},[]);const handleDelete=async(productId,productName)=>{if(window.confirm(`Are you sure to delete ${productName} item?`)){try{const response=await fetch(`${API_BASE_URL}/deleteProduct`,{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:`product_id=${productId}`});const result=await response.json();if(result.error){alert(result.error);}else{setProducts(products.filter(product=>product.product_id!==productId));}}catch(error){console.error('Error deleting product:',error);alert('An error occurred while deleting the product.');}}};const handleUpdate=product=>{setSelectedProduct(product);setShowModal(true);};const handleModalClose=()=>{setShowModal(false);setSelectedProduct(null);};const handleModalSave=()=>{setShowModal(false);setSelectedProduct(null);fetch(`${API_BASE_URL}/getProducts`).then(response=>response.json()).then(data=>setProducts(data||[]))// Ensure data is an array\n.catch(error=>console.error('Error fetching products:',error));};// Filter products based on search term\nconst filteredProducts=products.filter(product=>product.name.toLowerCase().includes(searchTerm.toLowerCase()));return/*#__PURE__*/_jsxs(\"div\",{className:\"right content-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"body content rows scroll-y\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Loading...\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"box-info full\",id:\"taskFormContainer\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Manage Products\"}),/*#__PURE__*/_jsx(\"div\",{className:\"panel-body pt-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-sm-12\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'16px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{marginBottom:'0'},children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Search by Product Name - \",filteredProducts.length+(filteredProducts.length>1?\" Products Found\":\" Product Found\")]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Enter product name\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),style:{maxWidth:'600px'}// Adjust width as needed\n})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-sm btn-success pull-right\",style:{marginRight:'28px',fontSize:'14px',fontWeight:'500'},onClick:()=>setShowModal(true),children:\"Add New Product\"})})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table products-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Unit\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Price Per Unit\"}),/*#__PURE__*/_jsx(\"th\",{style:{width:'150px'},children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredProducts.map(product=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:product.name}),/*#__PURE__*/_jsx(\"td\",{children:product.uom_name}),/*#__PURE__*/_jsx(\"td\",{children:product.price_per_unit}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-xs btn-warning\",style:{marginLeft:'0px',fontSize:'14px',fontWeight:'500'},onClick:()=>handleUpdate(product),children:\"Update\"}),\"\\xA0\\xA0\",/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-xs btn-danger\",style:{marginLeft:'0px',fontSize:'14px',fontWeight:'500'},onClick:()=>handleDelete(product.product_id,product.name),children:\"Delete\"})]})]},product.product_id))})]})]})})})]})]}),showModal&&/*#__PURE__*/_jsx(ProductModal,{onClose:handleModalClose,onSave:handleModalSave,product:selectedProduct})]});}export default ManageProduct;","map":{"version":3,"names":["React","useState","useEffect","ProductModal","jsx","_jsx","jsxs","_jsxs","API_BASE_URL","ManageProduct","products","setProducts","showModal","setShowModal","selectedProduct","setSelectedProduct","searchTerm","setSearchTerm","loading","setLoading","fetch","then","response","json","data","catch","error","console","finally","handleDelete","productId","productName","window","confirm","method","headers","body","result","alert","filter","product","product_id","handleUpdate","handleModalClose","handleModalSave","filteredProducts","name","toLowerCase","includes","className","children","id","style","display","justifyContent","alignItems","marginBottom","length","type","placeholder","value","onChange","e","target","maxWidth","marginRight","fontSize","fontWeight","onClick","width","map","uom_name","price_per_unit","marginLeft","onClose","onSave"],"sources":["C:/Users/rohit/PycharmProjects/Grocery_Store_Management_System/frontend/src/components/ManageProduct.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport ProductModal from './ProductModal';\r\n\r\nconst API_BASE_URL = \"https://grocery-store-management-system.onrender.com\";\r\n\r\nfunction ManageProduct() {\r\n  const [products, setProducts] = useState([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [selectedProduct, setSelectedProduct] = useState(null);\r\n  const [searchTerm, setSearchTerm] = useState(''); // New state for search\r\n  const [loading, setLoading] = useState(true); // New state for loading\r\n\r\n  useEffect(() => {\r\n    setLoading(true); // Set loading to true when fetch starts\r\n    fetch(`${API_BASE_URL}/getProducts`)\r\n      .then(response => response.json())\r\n      .then(data => setProducts(data || [])) // Ensure data is an array\r\n      .catch(error => console.error('Error fetching products:', error))\r\n      .finally(() => setLoading(false)); // Set loading to false when fetch completes or fails\r\n  }, []);\r\n\r\n  const handleDelete = async (productId, productName) => {\r\n    if (window.confirm(`Are you sure to delete ${productName} item?`)) {\r\n      try {\r\n        const response = await fetch(`${API_BASE_URL}/deleteProduct`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\r\n          body: `product_id=${productId}`\r\n        });\r\n        const result = await response.json();\r\n        if (result.error) {\r\n          alert(result.error);\r\n        } else {\r\n          setProducts(products.filter(product => product.product_id !== productId));\r\n        }\r\n      } catch (error) {\r\n        console.error('Error deleting product:', error);\r\n        alert('An error occurred while deleting the product.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUpdate = (product) => {\r\n    setSelectedProduct(product);\r\n    setShowModal(true);\r\n  };\r\n\r\n  const handleModalClose = () => {\r\n    setShowModal(false);\r\n    setSelectedProduct(null);\r\n  };\r\n\r\n  const handleModalSave = () => {\r\n    setShowModal(false);\r\n    setSelectedProduct(null);\r\n    fetch(`${API_BASE_URL}/getProducts`)\r\n      .then(response => response.json())\r\n      .then(data => setProducts(data || [])) // Ensure data is an array\r\n      .catch(error => console.error('Error fetching products:', error));\r\n  };\r\n\r\n  // Filter products based on search term\r\n  const filteredProducts = products.filter(product =>\r\n    product.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"right content-page\">\r\n      <div className=\"body content rows scroll-y\">\r\n        {loading && (\r\n          <div className=\"loading\">\r\n            <span>Loading...</span>\r\n          </div>\r\n        )}\r\n        <div className=\"box-info full\" id=\"taskFormContainer\">\r\n          <h2>Manage Products</h2>\r\n          <div className=\"panel-body pt-0\">\r\n            <div className=\"row mb-4\">\r\n              <div className=\"col-sm-12\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>\r\n                  <div className=\"form-group\" style={{ marginBottom: '0' }}>\r\n                    <label>Search by Product Name - {filteredProducts.length + (filteredProducts.length > 1 ? \" Products Found\" : \" Product Found\")}</label>\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control\"\r\n                      placeholder=\"Enter product name\"\r\n                      value={searchTerm}\r\n                      onChange={(e) => setSearchTerm(e.target.value)}\r\n                      style={{maxWidth: '600px' }} // Adjust width as needed\r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"btn btn-sm btn-success pull-right\"\r\n                      style={{ marginRight: '28px', fontSize: '14px', fontWeight: '500' }}\r\n                      onClick={() => setShowModal(true)}\r\n                    >\r\n                      Add New Product\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                <table className=\"table products-table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th>Name</th>\r\n                      <th>Unit</th>\r\n                      <th>Price Per Unit</th>\r\n                      <th style={{ width: '150px' }}>Action</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {filteredProducts.map(product => (\r\n                      <tr key={product.product_id}>\r\n                        <td>{product.name}</td>\r\n                        <td>{product.uom_name}</td>\r\n                        <td>{product.price_per_unit}</td>\r\n                        <td>\r\n                          <button\r\n                            type=\"button\"\r\n                            className=\"btn btn-xs btn-warning\"\r\n                            style={{ marginLeft: '0px', fontSize: '14px', fontWeight: '500' }}\r\n                            onClick={() => handleUpdate(product)}\r\n                          >\r\n                            Update\r\n                          </button>\r\n                            \r\n                          <button\r\n                            type=\"button\"\r\n                            className=\"btn btn-xs btn-danger\"\r\n                            style={{ marginLeft: '0px', fontSize: '14px', fontWeight: '500' }}\r\n                            onClick={() => handleDelete(product.product_id, product.name)}\r\n                          >\r\n                            Delete\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {showModal && (\r\n        <ProductModal\r\n          onClose={handleModalClose}\r\n          onSave={handleModalSave}\r\n          product={selectedProduct}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ManageProduct;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}